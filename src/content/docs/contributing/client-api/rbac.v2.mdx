---
title: "Package: rbac.v2"
docType: client-package
package:
  classes:
    - name: Workspace
      description: Represents a workspace object from RBAC v2 API
      properties:
        - name: id
          type:
            name: string
          description: Workspace identifier
        - name: name
          type:
            name: string
          description: Workspace name
        - name: type
          type:
            name: string
          description: Workspace type (e.g., "root", "default")
        - name: description
          type:
            name: string
          description: Workspace description
  functions:
    - name: fetchRootWorkspace
      description: |
        Fetches the root workspace for the specified organization.
        This function queries RBAC v2 to find the root workspace for the given orgId.

        GET /api/rbac/v2/workspaces/?type=root

        Example:

        ```python
        from kessel.auth import fetchOIDCDiscovery, OAuth2ClientCredentials
        from kessel.requests import oauth2Auth
        from kessel.rbac.v2 import fetchRootWorkspace

        # Configure OAuth2 credentials
        discovery = fetchOIDCDiscovery("https://sso.example.com/auth/")
        authCredentials = OAuth2ClientCredentials(
            clientId="your-client-id",
            clientSecret="your-client-secret",
            tokenEndpoint=discovery.tokenEndpoint,
        )

        # Create auth adapter
        auth = oauth2Auth(authCredentials)

        # Fetch the root workspace
        rootWorkspace = fetchRootWorkspace(
            rbacBaseEndpoint="https://console.stage.redhat.com/",
            orgId="12345",
            auth=auth
        )
        print(f"Root workspace: {rootWorkspace.name}")
        workspaceId = rootWorkspace.id
        ```

      params:
        - name: rbacBaseEndpoint
          type:
            name: string
          description: The RBAC service endpoint URL (stage/prod/ephemeral)
        - name: orgId
          type:
            name: string
          description: Organization ID to use for the request.
        - name: auth
          type:
            name: AuthRequest
            link: "../auth#interface-AuthRequest"
          optional: true
          description: |
            Used to perform authenticated requests.
        - name: httpClient
          type:
            name: HttpClient
          optional: true
          description: |
            Optional HTTP client instance (e.g., requests, http.Client) if applicable.
            If not provided, uses the default HTTP client for the language.
            Allows users to inject custom HTTP clients with additional headers or configuration.
            This is not expected to support any custom HTTP client, some of the language constructs
            will be used and thus we will only support the default or most used client. e.g. python will
            support `requests` and any requests-compatible client. Node.js will support the `fetch` API and Go will
            only use `http.Client`.
      returns:
        name: Workspace
        link: "#class-Workspace"
        description: |
          A Workspace object representing the root workspace for the organization.

    - name: fetchDefaultWorkspace
      description: |
        Fetches the default workspace for the specified organization.
        This function queries RBAC v2 to find the default workspace for the given orgId.

        GET /api/rbac/v2/workspaces/?type=default

        Example:

        ```python
        from kessel.auth import fetchOIDCDiscovery, OAuth2ClientCredentials
        from kessel.requests import oauth2Auth
        from kessel.rbac.v2 import fetchDefaultWorkspace

        # Configure OAuth2 credentials
        discovery = fetchOIDCDiscovery("https://sso.example.com/auth/")
        authCredentials = OAuth2ClientCredentials(
            clientId="your-client-id",
            clientSecret="your-client-secret",
            tokenEndpoint=discovery.tokenEndpoint,
        )

        # Create auth adapter
        auth = oauth2Auth(authCredentials)

        # Fetch the default workspace
        defaultWorkspace = fetchDefaultWorkspace(
            rbacBaseEndpoint="https://console.stage.redhat.com/",
            orgId="12345",
            auth=auth
        )
        print(f"Default workspace: {defaultWorkspace.name}")
        workspaceId = defaultWorkspace.id
        ```

      params:
        - name: rbacBaseEndpoint
          type:
            name: string
          description: The RBAC service endpoint URL (stage/prod/ephemeral)
        - name: orgId
          type:
            name: string
          description: Organization ID to use for the request.
        - name: auth
          type:
            name: AuthRequest
            link: "../auth#interface-AuthRequest"
          optional: true
          description: |
            Used to perform authenticated requests.
        - name: httpClient
          type:
            name: HttpClient
          optional: true
          description: |
            Optional HTTP client instance (e.g., requests, http.Client) if applicable.
            If not provided, uses the default HTTP client for the language.
            Allows users to inject custom HTTP clients with additional headers or configuration.
            This is not expected to support any custom HTTP client, some of the language constructs
            will be used and thus we will only support the default or most used client. e.g. python will
            support `requests` and any requests-compatible client. Node.js will support the `fetch` API and Go will
            only use `http.Client`.
      returns:
        name: Workspace
        link: "#class-Workspace"
        description: |
          A Workspace object representing the root workspace for the organization.

    - name: workspaceType
      description: |
        Function to create a RepresentationType for workspace resources.
        Returns a protobuf RepresentationType configured for RBAC workspace objects.

        Example:

        ```python
        workspaceType = workspaceType()
        ```
      params: []
      returns:
        name: RepresentationType
        link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.RepresentationType
        description: A RepresentationType for workspace resources

    - name: roleType
      description: |
        Function to create a RepresentationType for role resources.
        Returns a protobuf RepresentationType configured for RBAC role objects.

        Example:

        ```python
        roleType = roleType()
        ```
      params: []
      returns:
        name: RepresentationType
        link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.RepresentationType
        description: A RepresentationType for role resources

    - name: principalResource
      description: |
        Creates a ResourceReference for a user principal based on user ID and domain.
        This function standardizes the creation of principal resources.

        Example:

        ```python
        userResource = principalResource("123", "redhat")
        ```
      params:
        - name: id
          type:
            name: string
          description: The user identifier
        - name: domain
          type:
            name: string
          description: The domain or organization the user belongs to
      returns:
        name: ResourceReference
        link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.ResourceReference
        description: A ResourceReference pointing to the user's principal resource

    - name: roleResource
      description: |
        Function to create a ResourceReference for a role.
        Returns a protobuf ResourceReference configured for RBAC role resources.

        Example:

        ```python
        adminRole = roleResource("admin")
        ```
      params:
        - name: resourceId
          type:
            name: string
          description: The role identifier
      returns:
        name: ResourceReference
        link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.ResourceReference
        description: A ResourceReference for the role

    - name: workspaceResource
      description: |
        Function to create a ResourceReference for a workspace.
        Returns a protobuf ResourceReference configured for RBAC workspace resources.

        Example:

        ```python
        projectWorkspace = workspaceResource("project-abc")
        ```
      params:
        - name: resourceId
          type:
            name: string
          description: The workspace identifier
      returns:
        name: ResourceReference
        link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.ResourceReference
        description: A ResourceReference for the workspace

    - name: principalSubject
      description: |
        Creates a SubjectReference for a user principal based on user ID and domain.
        This is a convenience function that wraps principalResource to create a subject reference.

        Example:

        ```python
        userSubject = principalSubject("john.doe", "example.com")
        ```
      params:
        - name: id
          type:
            name: string
          description: The user identifier
        - name: domain
          type:
            name: string
          description: The domain or organization the user belongs to
      returns:
        name: SubjectReference
        link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.SubjectReference
        description: A SubjectReference for the user's principal

    - name: subject
      description: |
        Creates a SubjectReference from a ResourceReference and an optional relation.
        This function allows you to easily create a subject reference.

        Example:

        ```python
        # Create a subject reference from a principal resource with a relation
        memberSubject = subject(principalResource("123", "redhat"), "member")
        
        # Create a subject reference without a relation (direct subject)
        directSubject = subject(principalResource("456", "redhat"))
        
        # Create a subject reference using a manually constructed ResourceReference
        customResource = ResourceReference(
            resourceType="group",
            resourceId="our-team",
            reporter=None
        )
        groupSubject = subject(customResource, "owner")
        ```
      params:
        - name: resourceRef
          type:
            name: ResourceReference
            link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.ResourceReference
          description: The resource reference that identifies the subject
        - name: relation
          type:
            name: string
          description: Optional relation that points to a set of subjects (e.g., "members", "owners")
          optional: true
      returns:
        name: SubjectReference
        link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.SubjectReference
        description: A reference to a Subject or, if a relation is provided, a Subject Set.

    - name: listWorkspaces
      description: |
        Lists all workspaces that a subject has a specific relation to.
        This function queries the inventory service to find workspaces based on the subject's permissions.
        Default pagination limit is 1000 items per page.

        Example:

        ```python
        userSubject = principalSubject("john.doe", "redhat.com")
        for resp in listWorkspaces(inventoryClient, userSubject, "member"):
            print(resp)
        ```
      params:
        - name: inventory
          type:
            name: KesselInventoryServiceStub
          description: The inventory service client stub for making the request
        - name: subject
          type:
            name: SubjectReference
            link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.SubjectReference
          description: The subject to check permissions for
        - name: relation
          type:
            name: string
          description: The relationship type to check
        - name: continuationToken
          type:
            name: string
          description: Optional token to resume listing from a previous page
          optional: true
      returns:
        name: "Iterable[StreamedListObjectsResponse]"
        link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.StreamedListObjectsResponse
        description: An iterator of streamed responses containing workspace objects and pagination info

    - name: listWorkspacesAsync
      description: |
        Lists all workspaces that a subject has a specific relation to.
        This function queries the inventory service to find workspaces based on the subject's permissions.
        Default pagination limit is 1000 items per page.

        Example:

        ```python
        userSubject = principalSubject("john.doe", "redhat.com")
        async for resp in listWorkspacesAsync(inventoryClient, userSubject, "member"):
            print(resp)
        ```
      params:
        - name: inventory
          type:
            name: KesselInventoryServiceStub
          description: The inventory service client stub for making the request (async channel)
        - name: subject
          type:
            name: SubjectReference
            link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.SubjectReference
          description: The subject to check permissions for
        - name: relation
          type:
            name: string
          description: The relationship type to check
        - name: continuationToken
          type:
            name: string
          description: Optional token to resume listing from a previous page
          optional: true
      returns:
        name: "AsyncIterator[StreamedListObjectsResponse]"
        link: https://buf.build/project-kessel/inventory-api/docs/main:kessel.inventory.v1beta2#kessel.inventory.v1beta2.StreamedListObjectsResponse
        description: An async iterator of streamed responses containing workspace objects and pagination info
---

Package for RBAC v2 client methods.
